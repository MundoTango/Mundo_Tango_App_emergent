create table if not exists trips (trip_id uuid primary key default gen_random_uuid(), user_id uuid not null references profiles(id) on delete cascade, event_id uuid references events(id) on delete set null, origin_city text not null, destination_city text not null, start_date date not null, end_date date not null, travel_status text check (travel_status in ('planned','booked','completed','canceled')) default 'planned', created_at timestamptz default now(), updated_at timestamptz default now()); create index if not exists trips_user_idx on trips(user_id); create index if not exists trips_event_idx on trips(event_id); create table if not exists trip_participants (trip_id uuid not null references trips(trip_id) on delete cascade, participant_id uuid not null references profiles(id) on delete cascade, role text check (role in ('organizer','traveler','guest')) default 'traveler', created_at timestamptz default now(), primary key (trip_id, participant_id));